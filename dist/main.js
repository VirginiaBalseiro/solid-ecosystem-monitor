(()=>{const t=["template.md","README.md"],e=document.querySelector("main > article");function a(t,a,n){for(var r=document.createElement("table"),o=document.createElement("thead"),i=document.createElement("tr"),s=0;s<a.length;s++){var c=document.createElement("th");c.textContent=a[s],i.appendChild(c)}o.appendChild(i);var d=document.createElement("tbody");t.forEach((t=>{n(t,d)})),r.appendChild(o),r.appendChild(d),e.appendChild(r)}function n(t,e,a,n,r,o){const i=20*t.length-50-30,s=340,c=d3.select(`#${e}`).append("svg").attr("width",i+50+30).attr("height",400).append("g").attr("transform","translate(50,20)"),d=d3.scalePoint().domain(t.map((t=>t[a]))).range([0,i]),l=d3.scaleLinear().domain([0,d3.max(t,(t=>t[n]))]).nice().range([s,0]),p=d3.line().x((t=>d(t[a]))).y((t=>l(t[n])));c.append("path").datum(t).attr("class","line").attr("fill","none").attr("stroke","blue").attr("stroke-width",2).attr("d",p),c.append("g").attr("class","x-axis").attr("transform","translate(0, 340)").call((function(t){t.call(d3.axisBottom(d)).selectAll("text").style("text-anchor","end").attr("dx","-0.8em").attr("dy","0.15em").attr("transform","rotate(-45)")})),c.append("g").attr("class","y-axis").call(d3.axisLeft(l)),c.append("text").attr("x",i/2).attr("y",380).attr("text-anchor","middle").text(r),c.append("text").attr("transform","rotate(-90)").attr("x",-170).attr("y",-50).attr("dy","1em").style("text-anchor","middle").text(o)}async function r(t){try{const e=await fetch(t);if(e.ok){const t=(await e.text()).split("\n");let a=!1,n=0;for(const e of t)if(e.startsWith("## Present"))a=!0;else{if(a&&""===e.trim())break;a&&n++}return n}return console.error(`Failed to fetch Markdown file. Status code: ${e.status}`),0}catch(t){return console.error("Error:",t.message),0}}!async function(){let o=!0;const i=document.createElement("div");i.classList.add("spinner");try{const s=await fetch("https://api.github.com/repositories/186702057/contents/meetings",{method:"GET"});if(o&&e.appendChild(i),s.ok){o=!1;const c=await s.json(),d=[];for(const e of c)if("file"===e.type&&e.name.endsWith(".md")&&!t.includes(e.name)){const t=e.download_url,a=await r(t);d.push({file:e,participantsCount:a})}const l=d.reduce(((t,e)=>{const a=new Date(e.file.name.substr(0,e.file.name.indexOf(".md"))),n=a.getFullYear(),r=a.getMonth(),o=`${n}-${r}`;return t[o]?(t[o].totalParticipantsCount+=e.participantsCount,t[o].fileCount+=1):t[o]={year:n,month:r,totalParticipantsCount:e.participantsCount,fileCount:1},t}),{}),p=Object.values(l).map((t=>({year:t.year,month:t.month,averageParticipantsCount:t.totalParticipantsCount/t.fileCount})));o||(e.removeChild(i),a(d,["Meeting","Participants"],((t,e)=>{console.log(t);var a=document.createElement("tr");a.setAttribute("about","#"+t.file.sha),a.setAttribute("typeof","qb:Observation");var n=document.createElement("td");n.setAttribute("property","sdmx-dimension:refPeriod"),n.setAttribute("datatype","xsd:date");var r=document.createElement("a");r.href=t.file.html_url,r.textContent=t.file.name.slice(0,-3),n.appendChild(r),a.appendChild(n);var o=document.createElement("td");o.setAttribute("property","sdmx-measure:obsValue"),o.setAttribute("datatype","xsd:int"),o.textContent=t.participantsCount,a.appendChild(o),e.appendChild(a)})),a(p,["Month","Average Participants"],((t,e)=>{var a=document.createElement("tr"),n=document.createElement("td");n.textContent=`${t.year}-${t.month+1}`,a.appendChild(n);var r=document.createElement("td");r.textContent=`${Math.floor(t.averageParticipantsCount)}`,a.appendChild(r),e.appendChild(a)})),n(d.map((t=>({date:t.file.name,participantsCount:t.participantsCount}))),"line-chart-meetings","date","participantsCount","Meeting","Participants"),n(p.map((t=>({month:`${t.year}-${t.month+1}`,averageParticipantsCount:t.averageParticipantsCount}))),"line-chart-monthly","month","averageParticipantsCount","Month","Average Participants"))}else console.error(`Failed to fetch directory contents. Status code: ${s.status}`)}catch(t){console.error("Error:",t.message)}}()})();