(()=>{const t=["template.md","README.md"],e=document.querySelector("main > article"),a=(t,e)=>{const a=(e+1).toString();return`${t}-${1==a.length?`0${a}`:a}`};function n(t,a,n){for(var r=document.createElement("table"),o=document.createElement("thead"),i=document.createElement("tr"),s=0;s<a.length;s++){var d=document.createElement("th");d.textContent=a[s],i.appendChild(d)}o.appendChild(i);var c=document.createElement("tbody");t.forEach((t=>{n(t,c)})),r.appendChild(o),r.appendChild(c),e.appendChild(r)}function r(t,a,n,r,o,i){const s=20*t.length-50-30,d=360,c=document.createElement("div");c.id=a,c.classList.add("chart"),e.appendChild(c);const l=d3.select(`#${a}`).append("svg").attr("width",s+50+30).attr("height",500).append("g").attr("transform","translate(50,20)"),p=d3.scalePoint().domain(t.map((t=>t[n]))).range([0,s]),m=d3.scaleLinear().domain([0,d3.max(t,(t=>t[r]))]).nice().range([d,0]),u=d3.line().x((t=>p(t[n]))).y((t=>m(t[r])));l.append("path").datum(t).attr("class","line").attr("fill","none").attr("stroke","blue").attr("stroke-width",2).attr("d",u),l.append("g").attr("class","x-axis").attr("transform","translate(0, 360)").call((function(t){t.call(d3.axisBottom(p)).selectAll("text").style("text-anchor","end").attr("dx","-0.8em").attr("dy","0.15em").attr("transform","rotate(-45)")})),l.append("g").attr("class","y-axis").call(d3.axisLeft(m)),l.append("text").attr("x",s/2).attr("y",440).attr("text-anchor","middle").text(o),l.append("text").attr("transform","rotate(-90)").attr("x",-180).attr("y",-50).attr("dy","1em").style("text-anchor","middle").text(i)}async function o(t){try{const e=await fetch(t);if(e.ok){const t=(await e.text()).split("\n");let a=!1,n=0;for(const e of t)if(e.startsWith("## Present"))a=!0;else if(a&&(e.startsWith("-")||e.startsWith("*")))n++;else if(a&&n>0&&""===e.trim())break;return n}return console.error(`Failed to fetch Markdown file. Status code: ${e.status}`),0}catch(t){return console.error("Error:",t.message),0}}!async function(){let i=!0;const s=document.createElement("div");s.id="progress-indicator-container";const d=document.createElement("progress"),c=document.createElement("label");c.setAttribute("for","progress-indicator"),c.textContent="Fetching data...",d.id="progress-indicator",d.value=0,d.max=100,s.appendChild(c),s.appendChild(d);try{const c=await fetch("https://api.github.com/repositories/186702057/contents/meetings",{method:"GET"});if(i&&e.appendChild(s),c.ok){i=!1;const l=await c.json(),p=[],m=100/l.length;for(const e of l)if(d.value+=m,"file"===e.type&&e.name.endsWith(".md")&&!t.includes(e.name)){const t=e.download_url,a=await o(t);p.push({file:e,participantsCount:a})}const u=p.reduce(((t,e)=>{const a=new Date(e.file.name.substr(0,e.file.name.indexOf(".md"))),n=a.getFullYear(),r=a.getMonth(),o=`${n}-${r}`;return t[o]?(t[o].totalParticipantsCount+=e.participantsCount,t[o].fileCount+=1):t[o]={year:n,month:r,totalParticipantsCount:e.participantsCount,fileCount:1},t}),{}),h=Object.values(u).map((t=>({year:t.year,month:t.month,averageParticipantsCount:t.totalParticipantsCount/t.fileCount})));i||(e.removeChild(s),n(p,["Meeting","Participants"],((t,e)=>{var a=document.createElement("tr");a.setAttribute("about","#"+t.file.sha),a.setAttribute("typeof","qb:Observation");var n=document.createElement("td");n.setAttribute("property","sdmx-dimension:refPeriod"),n.setAttribute("datatype","xsd:date");var r=document.createElement("a");r.href=t.file.html_url,r.textContent=t.file.name.slice(0,-3),n.appendChild(r),a.appendChild(n);var o=document.createElement("td");o.setAttribute("property","sdmx-measure:obsValue"),o.setAttribute("datatype","xsd:int"),o.textContent=t.participantsCount,a.appendChild(o),e.appendChild(a)})),n(h,["Month","Average Participants"],((t,e)=>{var n=document.createElement("tr"),r=document.createElement("td");r.textContent=a(t.year,t.month),n.appendChild(r);var o=document.createElement("td");o.textContent=`${Math.floor(t.averageParticipantsCount)}`,n.appendChild(o),e.appendChild(n)})),r(p.map((t=>({date:t.file.name,participantsCount:t.participantsCount}))),"line-chart-meetings","date","participantsCount","Meeting","Participants"),r(h.map((t=>({month:a(t.year,t.month),averageParticipantsCount:t.averageParticipantsCount}))),"line-chart-monthly","month","averageParticipantsCount","Month","Average Participants"))}else console.error(`Failed to fetch directory contents. Status code: ${c.status}`)}catch(t){console.error("Error:",t.message)}}()})();